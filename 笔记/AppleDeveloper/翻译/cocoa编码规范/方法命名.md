# 方法命名
#程序员/翻译/cocoa编码规范

方法可能是编程接口中最常见的元素，所以您应该特别注意如何命名它们。本节讨论方法命名的以下方面:

## 一般规则
以下是一些命名方法是要记住的:
* 以小写字母开头，并大写第一个嵌入单词的字母。不使用前缀。看到排版约定。
这些指导方针有两个具体的例外。您可以以一个众所周知的TIFF大写首字母缩写(如TIFF或PDF)开始一个方法名，也可以使用前缀对私有方法进行分组和标识(参见private方法)。

* 对于表示对象所采取行动的方法，请以动词开头:
```obj-c
- (void)invokeWithTarget:(id)target;
- (void)selectTabViewItem:(NSTabViewItem *)tabViewItem
```
不要把“do”或“does”作为名字的一部分，因为这些助动词没有增加含意。此外，不要在动词前使用副词或形容词。

* 如果该方法返回一个属性，则以属性命名该方法。使用“get”是不必要的，除非间接返回一个或多个值。
```obj-c
- (NSSize)cellSize;		//Right.
- (NSSize)calcCellSize;	//Wrong.
- (NSSize)getCellSize;	//Wrong.
```

* 在所有参数之前使用关键字。
```
- (void)sendAction:(SEL)aSelector toObject:(id)anObject forAllCells:(BOOL)flag;		//Right.
- (void)sendAction:(SEL)aSelector :(id)anObject :(BOOL)flag;							//Wrong.
//（译者注：原来前面的关键字是可以不写的~！）
```

* 在形参名解释形参前添加一个单词来描述形参
```obj-c
- (id)viewWithTag:(NSInteger)aTag;		//Right.
- (id)taggedView:(int)aTag;				//Wrong.
```

* 在创建比继承的方法更具体的方法时，在现有方法的末尾添加新的关键字。
```obj-c
- (id)initWithFrame:(CGRect)frameRect;
- (id)initWithFrame:(NSRect)frameRect mode:(int)aMode cellClass:(Class)factoryId numberOfRows:(int)rowsHigh numberOfColumns:(int)colsWide;

```

* 不要使用“and”来链接作为接收者属性的关键字。
```
- (int)runModalForDirectory:(NSString *)path file:(NSString *) name types:(NSArray *)fileTypes;		//Right.
- (int)runModalForDirectory:(NSString *)path andFile:(NSString *)name andTypes:(NSArray *)fileTypes;	//Wrong.
```

虽然“and”在本例中听起来不错，但是当您创建具有越来越多关键字的方法时，它会导致问题。

* 如果该方法描述了两个独立的操作，请使用“和”来链接它们。
`- (BOOL)openFile:(NSString *)fullPath withApplication:(NSString *)appName andDeactivate:(BOOL)flag;`

## 存取方法（getter and setter）
访问器方法是那些设置和返回对象属性值的方法。他们有一些推荐的形式，具体取决于属性的表达方式:
* 如果属性表示为名词，格式为:
```obj-c
- (type)noun;
- (void)setNoun:(type)aNoun;
//For example:
- (NSString *)title;
- (void)setTitle:(NSString *)aTitle;
```

* 如果该属性表示为形容词，则格式为:
```obj-c
- (BOOL)isAdjective;
- (void)setAdjective:(BOOL)flag;
//For example:
- (BOOL)isEditable;
- (void)setEditable:(BOOL)flag;
```

* 如果该属性表示为动词，则格式为:
```obj-c
- (BOOL)verbObject;
- (void)setVerbObject:(BOOL)flag;
//For example:
- (BOOL)showsAlpha;
- (void)setShowsAlpha:(BOOL)flag;
```
这个动词应该用一般现在时。

* 不要用动词不定式把动词变成形容词:
```obj-c
- (void)setAcceptsGlyphInfo:(BOOL)flag;				//Right.
- (BOOL)acceptsGlyphInfo;							//Right.
- (void)setGlyphInfoAccepted:(BOOL)flag;			//Wrong.
- (BOOL)glyphInfoAccepted;							//Wrong.
```

* 你可以用情态动词(以can、should、will等开头的动词)来阐明意思，但不要用do或does。
```obj-c
- (void)setCanHide:(BOOL)flag;				//Right.
- (BOOL)canHide;								//Right.
- (void)setShouldCloseDocument:(BOOL)flag;	//Right.
- (BOOL)shouldCloseDocument;					//Right.
- (void)setDoesAcceptGlyphInfo:(BOOL)flag;	//Wrong.
- (BOOL)doesAcceptGlyphInfo;					//Wrong.
```

* 只对间接返回对象和值的方法使用“get”。只有当需要返回多个项时，才应该用之种方式。
`- (void)getLineDash:(float *)pattern count:(int *)count phase:(float *)phase;//NSBezierPath.`
在这样的方法中，方法的实现应该考虑这些In - out参数为NULL的情况。当对应的参数为NULL的时候，可以表示调用者对相应参数的返回值不感兴趣。

## 委托方法
委托方法是当某些事件发生时，对象在其委托(如果委托实现了它们)中调用的方法。它们具有独特的形式，同样适用于对象数据源中调用的方法:
* 以发送消息对象的类来开始名称:
```obj-c
- (BOOL)tableView:(NSTableView *)tableView shouldSelectRow:(int)row;
- (BOOL)application:(NSApplication *)sender openFile:(NSString *)filename;
```
类名省略了前缀，第一个字母是小写的。

* 冒号后接类名(参数是对委托对象的引用)，除非方法只有一个参数，即sender。
`- (BOOL)applicationOpenUntitledFile:(NSApplication *)sender;`

* 这方面的一个例外是由于发布通知而调用的方法。在本例中，惟一的参数是通知对象。
`- (void)windowDidChangeScreen:(NSNotification *)notification;`

* 对被调用的方法使用“did”或“will”，以通知委派某事已经发生或即将发生。
```obj-c
- (void)browserDidScroll:(NSBrowser *)sender;
- (NSUndoManager *)windowWillReturnUndoManager:(NSWindow *)window;
```

* 尽管可以使用“did”或“will”表示请求另一个对象做某事的方法，但“should”是首选。
`- (BOOL)windowShouldClose:(id)sender;`

## 集合操作类方法
对于管理集合的对象(每个对象都称为该集合的元素)，约定是具有以下形式的方法:
```obj-c
- (void)addElement:(elementType)anObj;
- (void)removeElement:(elementType)anObj;
- (NSArray *)elements;
//For example:
- (void)addLayoutManager:(NSLayoutManager *)obj;

- (void)removeLayoutManager:(NSLayoutManager *)obj;

- (NSArray *)layoutManagers;

```

以下是本准则的一些规定和改进:
* 如果集合确实是无序的，则返回NSSet对象而不是NSArray对象。
* 如果将元素插入集合中的特定位置是很重要的，请使用与以下类似的方法，而不是使用上述方法之外的方法:
```obj-c
- (void)insertLayoutManager:(NSLayoutManager *)obj atIndex:(int)index;

- (void)removeLayoutManagerAtIndex:(int)index;

```


有几个实现细节要记住:
* 这些方法通常意味着插入对象的所有权，因此添加或插入对象的代码必须retain它们，删除它们的代码也必须释放它们。
* 如果被插入的对象，还需要被读取。一般来讲你应该使用`set...`的形式来命名。并且，在实现中不能强引用对象。在`insertLayoutManager:atIndex:`的例子中，就是通过下面两个方法来处理的。
```obj-c
- (void)setTextStorage:(NSTextStorage *)textStorage;
- (NSTextStorage *)textStorage;
```

上述收集方法约定的另一个例子来自NSWindow类:
```obj-c
- (void)addChildWindow:(NSWindow *)childWin ordered:(NSWindowOrderingMode)place;

- (void)removeChildWindow:(NSWindow *)childWin;

- (NSArray *)childWindows;

 

- (NSWindow *)parentWindow;

- (void)setParentWindow:(NSWindow *)window;


```


## 方法参数
关于方法参数的名称有一些通用规则:
* 与方法一样，参数以小写字母开头，连续单词的首字母大写(例如，removeObject:(id)anObject)。
* 不要在名字中使用“pointer”或“ptr”。让参数的类型而不是它的名称声明它是否是一个指针。
* 避免使用一个或两个字母的名称作为参数。
* 避免缩写、只保存几个字母。

一般而言(在Cocoa中)，下面的关键字和参数一起使用:
```obj-c
...action:(SEL)aSelector

...alignment:(int)mode

...atIndex:(int)index

...content:(NSRect)aRect

...doubleValue:(double)aDouble

...floatValue:(float)aFloat

...font:(NSFont *)fontObj

...frame:(NSRect)frameRect

...intValue:(int)anInt

...keyEquivalent:(NSString *)charCode

...length:(int)numBytes

...point:(NSPoint)aPoint

...stringValue:(NSString *)aString

...tag:(int)anInt

...target:(id)anObject

...title:(NSString *)aString


```

## 私有方法
在大多数情况下，私有方法名通常遵循与公共方法名相同的规则。然而，一个常见的约定是给私有方法加上前缀，这样就可以很容易地将它们与公共方法区分开来。即使使用这种约定，私有方法的名称也会引起一种特殊类型的问题。当您设计Cocoa框架类的子类时，您无法知道您的私有方法是否无意地覆盖命名相同的私有框架方法。

Cocoa框架中大多数私有方法的名称都有一个下划线前缀(例如，_fooData)来将它们标记为私有。根据这一事实，我们提出以下两点建议。
* 不要使用下划线字符作为您的私有方法的前缀。苹果公司保留本公约。
* 如果您正在子类化一个大型Cocoa框架类(如NSView或UIView)，并且您希望绝对确保您的私有方法与超类中的方法具有不同的名称，那么您可以将自己的前缀添加到私有方法中。前缀应该尽可能惟一，可能是基于您的公司或项目以及“XX_”形式的前缀。因此，如果您的项目被称为字节Flogger，那么前缀可能是BF_addObject:

虽然给私有方法名称加上前缀的建议似乎与前面的声明相矛盾，即方法存在于类的名称空间中，但是这里的目的是不同的:防止无意地覆盖超类私有方法。


